<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | TLOU</title>

    <link rel="stylesheet" href="style/index.css">
    <link rel="stylesheet" href="style/dashboard.css">
    <link rel="icon" href="./assets/img/logo.webp">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="header">
        <div class="container">
            <div class="logo">
                <a href="index.html"><img src="./assets/img/logo.webp" alt="" height="50px"></a>
            </div>
            <ul class="navItens">
                <li>
                    <a href="#section_seuFinal">Seu Final</a>
                </li>
                <li>
                    <a href="#section_grafico">Gráficos</a>
                </li>
                <li>
                    <a href="../public/minigame.html">Minigame ▸</a>
                </li>
            </ul>
            <div class="perfil">
                <div class="nomeUsuario">
                    <span>Olá, <span id="span_usuario">Usuário</span></span>
                </div>
                <div class="iconePerfil"><img src="./assets/img/iconePerfil.png"></div>
            </div>
        </div>
    </div>
    <div class="fraseEllie">
        <div class="container">
            <span>“Depois de tudo o que passamos juntos. De tudo o que eu fiz. Não pode ser em vão.”</span>
            <span>-Ellie</span>
        </div>
    </div>
    <section id="section_seuFinal">
        <div class="final">
            <div class="titulo">
                <h1>Escolha seu Final</h1>
            </div>
            <div class="tutorial">
                <span>E se você pudesse escolher seu final?</span>
                <span>E se, por acaso, estivesse em suas mãos a escolha de matar a Abby e se vingar pelo Joel...</span>
                <span>Ou poupar sua vida e quebrar o ciclo de vingança.</span>
                <span>Qual seria sua escolha?</span>
            </div>
            <div class="imagens">
                <section>
                    <img id="img1" src="./assets/img/ellieFinal.jpg" onclick="escolha('A')">
                    <p class="ellieFinal">Salvar a Abby</p>

                    <img id="img2" src="./assets/img/abbyFinal.png" onclick="escolha('B')">
                    <p class="abbyFinal">Matar a Abby</p>
                </section>
            </div>
        </div>
    </section>
    <div class="questionario" id="pergunta1">
        <div class="container">
            <div class="indicador">
                <span id="span_indicador">1/3</span>
            </div>
            <div class="pergunta">
                <span id="span_pergunta">Por que você escolheu essa opção?</span>
            </div>
            <div class="botao" id="div_alternativa">
                <button onclick="pegarResposta('A')" id="id_buttonA">A. Para quebrar o ciclo de vingança e trazer paz para a
                    Ellie.</button>
                <button onclick="pegarResposta('B')" id="id_buttonB">B. Para vingar a morte do Joel, que foi um pai para a
                    Ellie.</button>
                <button onclick="pegarResposta('C')" id="id_buttonC">C. Porque senti empatia pela Abby e entendi suas razões.</button>
                <button onclick="pegarResposta('D')" id="id_buttonD">D. Outra razão...</button>
            </div>
        </div>
    </div>
    <section id="section_grafico">
        <div class="dash">
            <div class="kpi">
                <span id="span_mensagem">Total de Votos: 0</span>
            </div>
            <div class="interacao">
                <div class="graficoAlinhado">
                    <div class="grafico">
                        <canvas id="myChart1"></canvas>
                    </div>
                    <div class="grafico">
                        <canvas id="Pergunta1"></canvas>
                    </div>
                </div>
                <div class="graficoAlinhado">
                    <div class="grafico">
                        <canvas id="Pergunta2"></canvas>
                    </div>
                    <div class="grafico">
                        <canvas id="Pergunta3"></canvas>
                    </div>
                </div>
            </div>
            <div class="publico">
                <h1>Público</h1>
            </div>
            <div class="kpi">
                <span id="span_ps">Quantidade de acessos no site oficial da Playstation: 0</span>
            </div>
            <div class="kpi">
                <span id="span_hbo">Quantidade de acessos no site oficial da HBO: 0</span>
            </div>
            <div class="graficoAlinhado">
                <div class="grafico2">
                    <canvas id="myChart2"></canvas>
                </div>
            </div>
            <div class="graficoAlinhado">
                <div class="grafico2">
                    <canvas id="myChart3"></canvas>
                </div>
            </div>
        </div>
    </section>
    <div class="imgRodape"></div>
</body>

</html>

<script>
    // WEB-DATA-VIZ
    if (sessionStorage.NOME_USUARIO != undefined) {
        span_usuario.innerHTML = sessionStorage.NOME_USUARIO;
    }

    // CONTABILIDADE DE VOTOS
    var votoA = 0;
    var votoB = 0;

    // VOTOS
    function escolha(resposta) {
        if (resposta == 'A') {
            votoA++;
        }

        if (resposta == 'B') {
            votoB++;
        }
        span_mensagem.innerHTML = `Total de Votos: ${votoA + votoB}`;
    }

    // QUESTIONARIO
    var click = 1;

    function pegarResposta(resposta) {
        if (click == 1) {
            span_indicador.innerHTML = `2/3`;
            span_pergunta.innerHTML = `Como você se sentiu ao fazer essa escolha?`;
            id_buttonA.innerHTML = `A. Aliviado(a), como se tivesse feito a coisa certa.`;
            id_buttonB.innerHTML = `B. Triste, mas achei que era necessário.`;
            id_buttonC.innerHTML = `C. Com raiva e desejo de vingança.`;
            id_buttonD.innerHTML = `D. Conflituoso(a), pois não foi uma decisão fácil.`;
            
            click++;
        } else if (click == 2) {
            span_indicador.innerHTML = `3/3`;
            span_pergunta.innerHTML = `Qual você acha que seria o impacto dessa escolha no futuro dos personagens?`;
            id_buttonA.innerHTML = `A. Traria paz e encerraria o ciclo de vingança.`;
            id_buttonB.innerHTML = `B. Provocaria mais conflitos e possíveis retaliações.`;
            id_buttonC.innerHTML = `C. Permitiria à Ellie seguir em frente com menos peso emocional.`;
            id_buttonD.innerHTML = `D. Marcaria a Ellie com um novo trauma.`;

            click = 0;
        } else {
            window.location.hash = "section_grafico";
        }
    }

    // CLICKES
    var clickPS = 0;
    var clickHBO = 0;

    function link(resposta) {
        if (resposta == 'PS') {
            clickPS++;
        }

        if (resposta == 'HBO') {
            clickHBO++;
        }

        document.getElementById(span_ps) = `Quantidade de acessos no site oficial da Playstation: ${clickPS}`;
    }

    // GRAFICOS E KPI's

    const dados1 = document.getElementById('myChart1');

    // GRÁFICO 1
    new Chart(dados1, {
        type: 'doughnut',
        data: {
            labels: ['Salvar', 'Matar'],
            datasets: [{
                data: [25, 75],
                backgroundColor: [
                    'rgb(89, 192, 75)',
                    'rgb(195, 58, 58)'
                ],
                borderWidth: 0
            }]
        },
    }
    );

    // GRAFICO PERGUNTAS
    const dadosP1 = document.getElementById('Pergunta1');

    new Chart(dadosP1, {
        type: 'bar',
        data: {
            labels: ['Quebrar o ciclo de vingança', 'Vingar o Joel', 'Entende as razões da Abby', 'Outro'],
            datasets: [{
                label: 'Por que você escolheu essa opção?',
                data: [59, 75, 30, 37],
                backgroundColor: [
                    'rgb(255, 147, 23)',
                    'rgb(255, 147, 23)',
                    'rgb(255, 147, 23)',
                    'rgb(255, 147, 23)'
                ],
                borderWidth: 0
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });


    const dadosP2 = document.getElementById('Pergunta2');

    new Chart(dadosP2, {
        type: 'bar',
        data: {
            labels: ['Aliviado(a)', 'Triste', 'Com raiva', 'Conflituoso(a)'],
            datasets: [{
                label: 'Como você se sentiu ao fazer essa escolha?',
                data: [70, 27, 10, 60],
                backgroundColor: [
                    'rgb(222, 212, 82)',
                    'rgb(222, 212, 82)',
                    'rgb(222, 212, 82)',
                    'rgb(222, 212, 82)'
                ],
                borderWidth: 0
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    const dadosP3 = document.getElementById('Pergunta3');

    new Chart(dadosP3, {
        type: 'bar',
        data: {
            labels: ['Traria paz', 'Mais conflitos', 'Menor peso', 'Novo trauma'],
            datasets: [{
                label: 'Qual você acha que seria o impacto dessa escolha no futuro dos personagens?',
                data: [30, 50, 66, 80],
                backgroundColor: [
                    'rgb(75, 192, 192)',
                    'rgb(75, 192, 192)',
                    'rgb(75, 192, 192)',
                    'rgb(75, 192, 192)'
                ],
                borderWidth: 0
            }]
        },
        options: {
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });

    const dados2 = document.getElementById('myChart2');

    // GRÁFICO LINHA
    new Chart(dados2, {
        type: 'line',
        data: {
            labels: ['18 a 21 anos', '22 a 28 anos', '29 a 40 anos', '50+ anos'],
            datasets: [{
                label: 'Faixa Etária',
                data: [65, 59, 80, 81],
                fill: false,
                borderColor: 'rgb(75, 192, 192)',
                backgroundColor: 'rgb(75, 192, 192)',
                tension: 0.1
            }],
        }
    });

    const dados3 = document.getElementById('myChart3');

    // GRÁFICO 3
    new Chart(dados3, {
        type: 'bar',
        data: {
            labels: ['Playstation 5', 'Playstation 4', 'Playstation 3', 'Notebook/Desktop', 'Outro'],
            datasets: [{
                label: 'Dispositivos mais utilizados',
                data: [20, 40, 20, 60, 50],
                backgroundColor: [
                    'rgb(89, 192, 75)',
                    'rgb(195, 58, 58)',
                    'rgb(255, 147, 23)',
                    'rgb(222, 212, 82)',
                    'rgb(75, 192, 192)'
                ],
                borderWidth: 0
            }]
        },
        options: {
            indexAxis: 'y',
        }
    }
    );
</script>